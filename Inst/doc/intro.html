<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Yaru Tian" />

<meta name="date" content="2020-01-01" />

<title>Introduction to SC19089</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19089</h1>
<h4 class="author">Yaru Tian</h4>
<h4 class="date">2020-01-01</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>StatComp</strong> is a simple R package developed to compare the performance of R and R++ (implemented through the R package <em>Rcpp</em>) for the ‘Statistical Computing’ course. Two functions are considered, namely, <em>sse</em> (Use stratified sampling to estimate the integration.) and <em>xt</em> (estimate the number of events in possion process). For each function, both R and Rcpp versions are produced. Namely <em>sseR</em> and <em>xtR</em> for R and <em>sseC</em> and <em>xtC</em> for C++.</p>
<p>The R package ‘microbenchmark’ can be used to benchmark the above R and C++ functions.</p>
</div>
<div id="benchmarking-sser-and-ssec" class="section level2">
<h2>Benchmarking <em>sseR</em> and <em>sseC</em></h2>
<p>The source R code for <em>sseR</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">sseR=<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb1-2" title="2">f=<span class="cf">function</span>(x){x<span class="op">^</span>n<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb1-3" title="3">s=<span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb1-5" title="5">  s[i]=<span class="kw">mean</span>(<span class="kw">f</span>(<span class="kw">runif</span>(<span class="dv">4</span>,(i<span class="dv">-1</span>)<span class="op">*</span><span class="fl">0.25</span>,i<span class="op">*</span><span class="fl">0.25</span>)))</a>
<a class="sourceLine" id="cb1-6" title="6">}</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">mean</span>(s)</a>
<a class="sourceLine" id="cb1-8" title="8">}</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">sseR</span>(<span class="dv">0</span>);<span class="kw">sseR</span>(<span class="dv">1</span>);<span class="kw">sseR</span>(<span class="fl">1.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.6518701</code></pre>
<pre><code>## [1] 0.271519</code></pre>
<pre><code>## [1] 0.2098606</code></pre>
<p>the <em>R</em> are known to be slow. On the other hand, the following <em>Rcpp</em> code is much faster. The source code for <em>sseC</em> is as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">cppFunction</span>(<span class="st">&#39;double sseC(double n){</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  NumericVector s(4);</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">  for(int i=0;i&lt;4;i++){</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  NumericVector x=runif(4,i*0.25,(i+1)*0.25);</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="st">  NumericVector t(4);</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="st">  for(int j=0;j&lt;4;j++){</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="st">  t[j]=pow(x[j],n)*exp(-x[j]);</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="st">  }</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="st">  s[i]=mean(t);}</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="st">return mean(s);</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="st">  </span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb5-14" title="14"><span class="kw">sseC</span>(<span class="dv">0</span>);<span class="kw">sseC</span>(<span class="dv">1</span>);<span class="kw">sseC</span>(<span class="fl">1.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.6308583</code></pre>
<pre><code>## [1] 0.2716321</code></pre>
<pre><code>## [1] 0.2144217</code></pre>
<p>In order to empirically benchmark <em>seeR</em> and <em>seeC</em>,we have n=5. The R code for benchmark <em>vaccR</em> and <em>vaccC</em> is as follows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb9-2" title="2">tm2 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="dt">vR =</span> <span class="kw">sseR</span>(<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="dt">vC =</span> <span class="kw">sseC</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb9-5" title="5">)</a>
<a class="sourceLine" id="cb9-6" title="6">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(tm2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">expr</th>
<th align="right">lq</th>
<th align="right">median</th>
<th align="right">uq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">vR</td>
<td align="right">34.7005</td>
<td align="right">35.652</td>
<td align="right">38.451</td>
</tr>
<tr class="even">
<td align="left">vC</td>
<td align="right">3.2505</td>
<td align="right">3.601</td>
<td align="right">4.100</td>
</tr>
</tbody>
</table>
<p>The above results show an evident computational speed gain of C++ against R.</p>
</div>
<div id="benchmarking-xtr-and-xtc" class="section level2">
<h2>Benchmarking <em>xtR</em> and <em>xtC</em></h2>
<p>The source R code for <em>xtR</em> is as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">xtR=<span class="cf">function</span>(N,lambda){</a>
<a class="sourceLine" id="cb10-2" title="2">x=<span class="kw">rexp</span>(N,lambda)</a>
<a class="sourceLine" id="cb10-3" title="3">Tn=<span class="kw">vector</span>(<span class="dt">length=</span>N)</a>
<a class="sourceLine" id="cb10-4" title="4">Tn[<span class="dv">1</span>]=x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb10-6" title="6">  Tn[i]=Tn[i<span class="dv">-1</span>]<span class="op">+</span>x[i]</a>
<a class="sourceLine" id="cb10-7" title="7">} <span class="co">#the total time</span></a>
<a class="sourceLine" id="cb10-8" title="8">t=<span class="dv">10</span></a>
<a class="sourceLine" id="cb10-9" title="9">i=<span class="dv">1</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb10-11" title="11">  <span class="cf">if</span>(Tn[i]<span class="op">&lt;=</span>t<span class="op">&amp;&amp;</span>Tn[i<span class="op">+</span><span class="dv">1</span>]<span class="op">&gt;</span>t){</a>
<a class="sourceLine" id="cb10-12" title="12">    xt=i</a>
<a class="sourceLine" id="cb10-13" title="13">  }</a>
<a class="sourceLine" id="cb10-14" title="14">}</a>
<a class="sourceLine" id="cb10-15" title="15">xt</a>
<a class="sourceLine" id="cb10-16" title="16">}</a>
<a class="sourceLine" id="cb10-17" title="17">t=<span class="kw">numeric</span>(<span class="fl">1e3</span>)</a>
<a class="sourceLine" id="cb10-18" title="18"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e3</span>){</a>
<a class="sourceLine" id="cb10-19" title="19">  t[i]=<span class="kw">xtR</span>(<span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-20" title="20">}</a>
<a class="sourceLine" id="cb10-21" title="21"><span class="kw">plot</span>(t,<span class="dt">ylab =</span> <span class="st">&quot;xt&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">round</span>(<span class="kw">mean</span>(t))</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>The source R code for <em>xtC</em> is as follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">cppFunction</span>(<span class="st">&#39; NumericVector xtC(int N,double lambda){</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">NumericVector x=rexp(N,lambda);</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">NumericVector Tn(N);</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">NumericVector xt(1);</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">Tn[0]=x[0];</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">for(int i=1;i&lt;N;i++){</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="st">  Tn[i]=Tn[i-1]+x[i];</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="st">} </span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="st">for(int i=0;i&lt;N;i++){</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="st"> int t=10;</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="st">  if(Tn[i]&lt;=t&amp;&amp;Tn[i+1]&gt;t){</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">   xt=i;}}</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">return xt;</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb13-16" title="16">t=<span class="kw">numeric</span>(<span class="fl">1e3</span>)</a>
<a class="sourceLine" id="cb13-17" title="17"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e3</span>){</a>
<a class="sourceLine" id="cb13-18" title="18">  t[i]=<span class="kw">xtC</span>(<span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-19" title="19">}</a>
<a class="sourceLine" id="cb13-20" title="20"><span class="kw">plot</span>(t,<span class="dt">ylab =</span> <span class="st">&quot;xt&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmOpBmZmZmtrZmtttmtv+QOgCQOmaQkGaQ2/+2ZgC2/7a2///bkDrb2//b/9vb////tmb/25D//7b//9v///8y3NotAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALP0lEQVR4nO2di2IbKRJFSTLZtWcf8W480e4oNv//l6PuhqKKhr7QD6vt3JtYlhooqCOqQDKWnacW5e49gLOLgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIaGdA7t3oXoA0qsLdvHr7QHfW3QG59MD5Wjf1ksN1b0Au3TpTMK98H0JvDGgW2gQEzBEQMqdzUHXRWMhOR2fvuwNSLi6sqv3k9tL9AWWXuvp5g9gjoKYu9qy42hwBIXMrEsovlYNKqRguUibF415NnaYV8FSAirUaO26pauu0GT81oI4U01LV1mk0TkBNhptHsJsIaJu5kD9xmpBEG6ouJt5SDkJvR50TkHiCFhr7Sg4Sna9i2kCx7SkBNYdWXrF746gaVNoSkCegNgNvCejl8eF2e73F+OcfjebC24zhHQ9540O9+1hOoc5upWeJt9Qi/zY1kBxmezsO0OXLn8O9b03mRijjUKd/wW+5XE2hztllLEu8xX6d/qYa6AVNTBwGKKAZMUFzcazRy3DRSUlltMUIWXIsTsbZN4t1ZrdBvYB+fh0BXStBRkCcQQt6eRxSw28+pmtsTn4YFG59ShM6B8UMbsyYHCRpXttNSVgXZ99cqhCTWZffPYD8yOjT99tCVuFTASSrllq69F0vz7dqaO7GFC+9ZEk+68Asli5WD+XHzaBuczLJ3dKggi9Lo8mDVCLXxWmSbJh2wsmnaibqOj1aK+fSk5UZJ6AFcwRUMZenHp1U9YNZteDFLG2FFC+rkWmbW0qDSZ3KPv7QHDStYpOW9kF5UtTZUSaU034qeukr2kjeSSeWjlxIcyqORZDYZ+KoGfT6VH0RpgcVp7+LINI1/UBmSIQg7afWPtzm4afCRYjEDr0JRH079hj+9/jdF2KvT79hc78yoNsOqPIqVZn7pQE1mZunF0k7kgtsJQEmWULjszdWPlDSOaiolLf6/D4CUL6K6aQqXLK1J2Xlgl/SUCfs3HXnZpZ1dk8QTwBIpn703JTrvUsavAqCGFo+VXEajFm9TMexrQIVK8rS2ek3AbV5tJcIqNGcJmT6cOkrQvERouQYn3KNBSTXI/wcvVfJxlmD6W6X3wfNIJto03SpJlNXVG4I1Zgn+ZLR+wMyT3wYU1zY1WSYTQfrt4qrqVKadCHSvJ4vacKmyeLMv1R0Z0CSQORJDUXpSVZTPp9hCYkszMl/n5qn7JX1pO2rnBf5xYYEREDvFpDJKC1ps63SdqmV774zyC87LVNlVmUZ1HaMccVYA+jl9+/j99qPBNvNydSP+7aZZ17ziWuNlyjScZNufbo3x+WLd+d8xOP1gC4EVAL0nKzUfuT1awNKM2ibVA7ariJXxAH3vRLQ6/924LN2FUMu7WBDbMUnsRfQy+P0dvPrf7bmIAkHu6PJIsYVQcaQjNsk7+1FbcFnseZ93oWMQ0enV4HWA8hfh5+6+0v99NiSFfUEfVhA/vVpsLIpR3/oGTQRWv6hRaM5p1TPH7sl83o3cUHMrq4EdFvq//3kKiejVgNa4daq2rJnmNGYV10F6OXRTWdYN28U83iqORa3Sfmux2cB2kQpbqR0FE5BqiI0xuk6QP+Yps4uq9hHBLSPCKgR0ArtmLGB7S6/DwB0oKP9Ki2VdwYUxpVu1RDNzkcXhhe2WcBJuc+nQOGisaf3V97UlcAjIAJ6p4D6Vp+eKnk56Klqrsvv86xinerqxdsHdwbkYqClp1KHhM+GbB9X6sTA8+lCIcxkvxPD1XQpVkM4ExABvVNAXjliFi6zhtkFLTyKF33GJjqbGSu2jmxcbGgrn+GlxttkaaT6KLr8PgTQfNboGZFiUFexc0hjtjMrdiBfs5YuPksZotCPP8cMilE2uaDyRaiVqPnkvuJhs1gqjBuJZMG0dFk8htt0N9IhIAI6IaD2Dxawfplc4LNVrixrZF6ajJZtLV07Lgd1fLDAkmv112sGkNoR5Kt0ulK0pGdwsexIQI2/Fu7UP7V91DMsBpHPlzmDQa1T9l/a6cR1KzbWkRd5yKCygewPqPzBAuap/7UBcQYtAhp6b/tggehGmljGf1WQJYu8XviyeUVgBPjlrKwM+LRi+uNykO/5YAE9SJ8G6uIyGwsraTbjNoOo0rR3evbk9WXWiMk+vw/ZB6UH5r8Olvi8hjhJYZLFZtxYyTe9qZI+NAGfZot3YsCY6/GbgHo82i4CajPnZDeWMoJXmcMrFHI9NJDsE1330XGTXLJWKnF51Zk0Thmr0+9DAMk6mlLlLBVHdrFaoprSbCxUMy5LxKEvu/hlPJzT0Hv9PgKQphTHr2JIbus25L+2KqYCsdRP6rAyJCfRaUw2e7SfCKjFHAEhcyqh6KRrk+eiEZecUVk9pnabwPWdkrWUmVSd+wJKLpic6dOCA6yohKqWb5PsUz/mTsGWyuyzgTZ7tJec/lYIke7+ZhuY3vaVvgkoticg0P6cgPKsmZJsXh/nI+86+djEJPt4a+PegHLP9VY5q96UsTuHoJc2WSXKA20xt6P6zC3uXzaNQG2Oyp0QEAEhm3cBNP3GVMcnkjf0rna3XbkG2gxvA5QT3TGALvG96Oqb0t2rePYOxC6E5FVOvt/WlZqtdfT8+iRY2j5Puks7xxswdwgg9QNn9IPDFfoAgDiDkC7xNzZ3y0F52x1XtGVzB61i8eNuq7+3ucnBfVaxNnPvYx90R90N0LvRnQC1GQXl24q3Nt9WfR+jBLStnIAIaFs5ARHQtnICIqBt5R8f0EcSAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERDQ/oCubvzc5UzjwZkHU16uWNbPr9Pvgq5q/fPvP8pNW2zsDug6/MrmrNvXp9uly+CjlJcrVox++XP6RPA1rV8ex5MW86ZNNvYGNB1weM7/mOb02+SXzz+kvFJxwejK1tfpvNe8aZuNvQEJieJYP32X8sWKudG/fc+st7e+uofxrM68aZuN3QGNvlT+esnzbVSxfLFipuvnPx7HDLaq9VRt3rTNxt6AppguR/ZwaEbKlyrmGj9of/gjuKtaTwzmTdtsvCGga8zR/YA+hef6AwCqz9vp0NWqIJnyxC1nfIAQq2a+cEJ2VZKenLg5tKq1P1WSrq2d8fTeqmV+Oj16XblJmACdZZmv7L5+fn3Iy3s2isOZ0dGfddvMM20Uh7lS2L9fpmNd099+CeXFihVd4wuVNa1Dmpk3bbHBF6tABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEDnAzQ7TtB6RuEYERAQAQGdEtDL478e3Xjiajig8t9waGY4/zKcB6v+5aVDdFJAw7n829fzjcfVhQfDIazhFFXtE/iO0UkBPUxnNsdThM/hwngQ6vr5j9/fNOJOCujbeDBRzs5NaWjk9ezaDibupVMDugig8Mls34bDeJW/P3mQTg0om0GDXp/+2Xb2dy+dGlA4yRwujLp8+f/TWy5i5wY0Ll6yik3Z+lvr+fqddG5Adh90A/M8Hph+yzR9PkAnEwEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAf0FGy/rQgHpsOsAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">round</span>(<span class="kw">mean</span>(t))</a></code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>The R code for benchmarking <em>xtR</em> and <em>xtC</em> is as follows.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">tm2 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="dt">vR =</span> <span class="kw">xtR</span>(<span class="dv">100</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb16-3" title="3">  <span class="dt">vC =</span> <span class="kw">xtC</span>(<span class="dv">100</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-4" title="4">)</a>
<a class="sourceLine" id="cb16-5" title="5">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(tm2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">expr</th>
<th align="right">lq</th>
<th align="right">median</th>
<th align="right">uq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">vR</td>
<td align="right">21.701</td>
<td align="right">22.001</td>
<td align="right">22.5015</td>
</tr>
<tr class="even">
<td align="left">vC</td>
<td align="right">4.801</td>
<td align="right">5.102</td>
<td align="right">5.6010</td>
</tr>
</tbody>
</table>
<p>The results again show an evident computational speed gain of C++ against R. The source R code for <em>Brown</em> is as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">library</span>(e1071) </a>
<a class="sourceLine" id="cb17-2" title="2">Brown=<span class="cf">function</span>(t,n){</a>
<a class="sourceLine" id="cb17-3" title="3">N=<span class="dv">1000</span> </a>
<a class="sourceLine" id="cb17-4" title="4">m=n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb17-5" title="5">time=<span class="kw">seq</span>(<span class="dv">0</span>,t,<span class="dt">length=</span>N) </a>
<a class="sourceLine" id="cb17-6" title="6">path=<span class="kw">rwiener</span>(<span class="dt">end=</span><span class="dv">1</span>,<span class="dt">frequency=</span>N) </a>
<a class="sourceLine" id="cb17-7" title="7"><span class="kw">plot</span>(time,path,<span class="dt">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot; Standard BM&quot;</span>)</a>
<a class="sourceLine" id="cb17-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </a>
<a class="sourceLine" id="cb17-9" title="9">  path=<span class="kw">rwiener</span>(<span class="dt">end=</span><span class="dv">1</span>,<span class="dt">frequency=</span>N) </a>
<a class="sourceLine" id="cb17-10" title="10">  <span class="kw">lines</span>(time,path)</a>
<a class="sourceLine" id="cb17-11" title="11">}</a>
<a class="sourceLine" id="cb17-12" title="12">}</a>
<a class="sourceLine" id="cb17-13" title="13"><span class="kw">Brown</span>(<span class="dv">1</span>,<span class="dv">6</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> ## all hw hw 9.29</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># 3.4</span></a>
<a class="sourceLine" id="cb18-2" title="2">n=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb18-3" title="3">u=<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb18-4" title="4"></a>
<a class="sourceLine" id="cb18-5" title="5">Sigma1=.<span class="dv">05</span></a>
<a class="sourceLine" id="cb18-6" title="6">x=(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">*</span>Sigma1<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="st">&quot;sigma=0.05&quot;</span>)</a>
<a class="sourceLine" id="cb18-8" title="8">y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb18-9" title="9"><span class="kw">lines</span>(y,(y<span class="op">/</span>Sigma1<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(Sigma1<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">Sigma2=.<span class="dv">1</span></a>
<a class="sourceLine" id="cb19-2" title="2">x=(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">*</span>Sigma2<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="st">&quot;sigma=0.1&quot;</span>)</a>
<a class="sourceLine" id="cb19-4" title="4">y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb19-5" title="5"><span class="kw">lines</span>(y,(y<span class="op">/</span>Sigma2<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(Sigma2<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">Sigma3=.<span class="dv">2</span></a>
<a class="sourceLine" id="cb20-2" title="2">x=(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">*</span>Sigma3<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="st">&quot;sigma=0.2&quot;</span>)</a>
<a class="sourceLine" id="cb20-4" title="4">y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="kw">lines</span>(y,(y<span class="op">/</span>Sigma3<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(Sigma3<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb2//b/9vb////tmb/25D/27b//7b//9v///9TzKuGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ90lEQVR4nO2da2ObNhiFla5d3OyWtN3a7Bp360a7S0hi/v9fG0KAESAdBBIS9DwfUmNkAU9f3bAsREGsiNgnkDoUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQILag0614cT/vk++FuPjh/NnHN0KIrz74OrGGzQoqPyi5bLbzQ7V9cefv3CpiC5pNJi5+LT4K8U5tlr6e3RUPh7nxaCSSoI9X5X/2Nx/aCJLl5fndUTz76+lGXP59JS7eFh8P5Vsy8d+vZeEpXz6oKJFxUn7usvp0HUJPbw7ylczB75nGEZSp6ywvRglS5eXiSglSXNUpiryR0hVUJrsupBA9YnYiSEbJffFJlNeoBJUOLu9PR1ELupb7xFvpsUrx5b10c90VVG0PhOyliJXX8fwP9VIJUtdZuqkElW+ov7WFovjn96tOfVxnMRQk5b7zfK5RBKkS9YVsoytBTVPW1EEqxhoLp5+E3mBJxgQ9ln58B1CkOujxtSopvylBSodBkLT5/Jd/5Bv2Iib3evcTrZl//FlWwnXwWCNIqXjqCRpW0mH8xOwHnX4sfYzVQbqgvKpX+pV02/o1Be8pRPkqIgkqr/m7e1nOmuDRW7FBBL24f7zt1UGyo/hWdRQbx0H8RIqg923XZqwfNKyDhpV0Z6hRZdEG1y76QUXx6aoeWXZ60l9/MLdiz3/N+pd+en9Qg9Uqi7rruRtB4/T7xSmQhqCyAvm2CphLnHZl0hCUt61T7DMZkIag4vHNoR7ep0YigtKFggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDATVAzFcX3FIqEcRKU1ZNOi7x5sX9cBJ1uWy1ZevNUAuEi6OmmnYScfzaFjBEEcKyD6hBiHWSg+aXJwvgRZxblswZRzlCMvEoVCgLMPMNsUStWH3QThczP+TnWKUJ9RvtgqqY8n9Z0QeKcXsmhIC2VaF+pf8WOBOWW+cxTBbVizu/tQtBRiOuHr++7g4452Z1ldNLvQdBR/uyoih7TUMOhku6nTzSEnAerDy+lINNgdVJ2wiAoyfbMTZAcgZ3+LRZGkEHQSMWUAG6D1SZulKqZ2QlDERs0bUngdjKZar5y46/TJ2QnTHVQu7lhQT6yswnq/EmF1QXpnWYKGk1hFtTbnQBrC+qFyLCjKCiIguB+m6AisWHryveDJghKbMyxbgQNeoIUNLrbLmiPRWxKdqN3VylI2zVym2zso0mVsTUFjdwm25CgZpksT9mN7ZosKKVC1jkVucLM0q/crXXQSCpTHZSOIf1MFjvauyClaMG3pvZKevjS+GYyhrQTkavUyDXB5k/e2LOg8zJyC6aPeROUjKFOK+ZjdSPzZYnNC3ql/CybfehPUCqGBoK8TGwZ27NtQcfzOClMMy9c66BUDA0iyFN2wx1bF7QsF3jDbIagNAytNFgVwMXomwkJerq5bteSD1JJuwlKaRpDyhGUxH2PdQT1Bg9TBaVQyLpDjWs5VF02iX5wRaPFZbqg+IbOZ3CUizJfFsdFt82Ggtq/8yIouqHOWOxdNa3FMtRQs4JyW0U+Lqg/uHIpYrENaYKO5YVbhhqVoGpu2fRJnPsRVJatpxv5BAdzEZOCajWTp+AtFhTbULeSFvJhA5YqSAp6OFSCJk/i3JEgzNwIGozO3Zr5uIbcBMnW+rJwmcTpQVBcQ+eDT/pNfFUOLb/I3LOgo48fMo8JEoNdrj3pmIY6zbyP3+n6FhR/3Kr1g6Zj6i2FiaCY/aH2uNYGHuZi/H/ejyDL9PlZ2bVviOEuZ0FFvEFZp4gFuWHmSVC8cb3n41KQa3bgx4WTBcUvYoV6MuXR0ti3pdBcEPcsKL+4y+Ro3mLodIsqqICCIhnqNPPX1RDU+tUz7AvsWJDsKEpB9skLqC8wOhYb7JpXxOIYGkTQcdFd+5CC4hjq10HZsu7ingWpRmrhLKr+NThMqp/QisUwFLgf5FdQDEMUBOiNxZYubhdYUARDzRGPqnLOFs61F/1Nz4LWN1QfMG8q5/prHddcDPeDfAqKdG9RHa3TQ/b63bz/CFq9w6iO1hmBeZ3lGkDQ2mOORpCnVVpFf4uCxrLrbPkXFKmIbUnQqoY2KWjNBq0RBO8VumTX2QhTxMRwfyiCDDVG/4+91kHrdRvDCDpvhKqkRX9/KLYqqKspKAEF9S7BdzOv6w/GdgXpbWQwNiyoWGVYtmVBq3QZwwnqtzMBBG07glYRFN6QnyP0+oUrRlBwQxuPoPClLJgg0X2jdySPRSz4sHXjgqo/oggYSDsQFLak7UJQyMraLWP4c4VWkNDe6B3Jfz8okToIP8IvlqAiWDXtku2EB7DFExQqilwynXDnOmYEhWnxA0WQ0N/oHSlMBKl/fdfXjnUQeoRfdEHeS5pbbvARfrUgbxc74zOF32IWph8UV5A6BU+S9ipInYYHTTM/b/9B3bLr8lLEznJEn9ETN+IpDnv3gzbAuoJ2DAUB3ATxefN2+Lx5O5OfFh63+o3Xk548zWp6pnFT+s5tegQFOPwWBE1+3vxnK2jq8+Y/X0HeM6WgpFOun5tzphSUdMr1c3PO9DMVtCcoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQwKegvLuAVW5bzaq7s/oy0niLu5+NeYk1LeXDQfh4rm7hVZBcQaZdRUbbsKU83ZYvMtPV9LPJjbfD9aOXqWzPd3DAnyD1pVC9eIy2YU2p1uMxTKfpZ1MtFjr16MuWaWnwJ0i7Uutlj+w0BFs/ZfbiR4Mg/egvjYXbGY+CqrPKu6do+P51ZKdhQf1eynLTVAdpKfNnf94sf261wp8gFQR1KGgb1pTqHcPV6CllyTEJ0lJmcvrJoiXWzyQhKLfV0eeUtoVCdUEXlvh1JIUiZv4ie5jnpCKmqqJ5y7H1SaCStqy8p6XM6tkto5etpVSe/FTV0Zv5wrZ67DAbUwRpKdU8ndSK2MyO4sPB1toMsjH2pLWUsrbqTNZZgs+hRqY6+6r5yGxDjU7KuuCY0mp5FrahhpYytw1fnOBgFUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBEhdkJwz1nlE5fqkLqh5yns0Uhck5zy/8jct3J3kBRVHT79KmUn6gnLLJM8VSF7Q6fb7qKs2Ji8oe/Gfn+mqM0ldkJzy7GfC80xSF3SsZjxHrKZTFxQdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI8D/KxNX7WH/m/QAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">Sigma4=.<span class="dv">5</span></a>
<a class="sourceLine" id="cb21-2" title="2">x=(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">*</span>Sigma4<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="st">&quot;sigma=0.5&quot;</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="kw">lines</span>(y,(y<span class="op">/</span>Sigma4<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(Sigma4<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># 3.11</span></a>
<a class="sourceLine" id="cb22-2" title="2">n=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb22-3" title="3">x1=<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-4" title="4">x2=<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-5" title="5">u=<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb22-6" title="6">p=<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-7" title="7">k=<span class="kw">as.integer</span>(u <span class="op">&lt;</span><span class="st"> </span>p)</a>
<a class="sourceLine" id="cb22-8" title="8">y=k <span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>k) <span class="op">*</span><span class="st"> </span>x2 </a>
<a class="sourceLine" id="cb22-9" title="9"><span class="kw">hist</span>(y,<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">main =</span> <span class="st">&quot;y&quot;</span>)</a>
<a class="sourceLine" id="cb22-10" title="10"><span class="kw">lines</span>(<span class="kw">density</span>(y))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">u1=<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb23-2" title="2">k1=<span class="kw">as.integer</span>(u1<span class="op">&lt;</span>.<span class="dv">75</span>)</a>
<a class="sourceLine" id="cb23-3" title="3">y1=k1<span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>k1) <span class="op">*</span><span class="st"> </span>x2 </a>
<a class="sourceLine" id="cb23-4" title="4"><span class="kw">hist</span>(y1,<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">main =</span> <span class="st">&quot;p=0.75&quot;</span>)</a>
<a class="sourceLine" id="cb23-5" title="5"><span class="kw">lines</span>(<span class="kw">density</span>(y1),<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">u2=<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb24-2" title="2">k2=<span class="kw">as.integer</span>(u1<span class="op">&lt;</span>.<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb24-3" title="3">y2=k2<span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>k2) <span class="op">*</span><span class="st"> </span>x2 </a>
<a class="sourceLine" id="cb24-4" title="4"><span class="kw">hist</span>(y2,<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">main =</span> <span class="st">&quot;p=0.6&quot;</span>)</a>
<a class="sourceLine" id="cb24-5" title="5"><span class="kw">lines</span>(<span class="kw">density</span>(y2),<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># 3.18</span></a>
<a class="sourceLine" id="cb25-2" title="2">X=<span class="cf">function</span>(n,d,Sigma){</a>
<a class="sourceLine" id="cb25-3" title="3">  mu=<span class="kw">rep</span>(<span class="dv">0</span>,d)</a>
<a class="sourceLine" id="cb25-4" title="4">  ev=<span class="kw">eigen</span>(Sigma,<span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb25-5" title="5">  lambda =<span class="st"> </span>ev<span class="op">$</span>values</a>
<a class="sourceLine" id="cb25-6" title="6">  V =<span class="st"> </span>ev<span class="op">$</span>vectors</a>
<a class="sourceLine" id="cb25-7" title="7">  C =<span class="st"> </span>V <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(lambda)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V)</a>
<a class="sourceLine" id="cb25-8" title="8">  Z =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>d), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> d)</a>
<a class="sourceLine" id="cb25-9" title="9">  X =<span class="st"> </span>Z <span class="op">%*%</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(mu, n, d, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb25-10" title="10">  X</a>
<a class="sourceLine" id="cb25-11" title="11">}</a>
<a class="sourceLine" id="cb25-12" title="12">t=<span class="kw">X</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="kw">matrix</span>(<span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">2</span>,.<span class="dv">3</span>,.<span class="dv">4</span>,.<span class="dv">5</span>,.<span class="dv">6</span>,.<span class="dv">7</span>,.<span class="dv">8</span>,.<span class="dv">9</span>),<span class="dt">nrow =</span> <span class="dv">3</span>,<span class="dt">ncol =</span> <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb25-13" title="13"><span class="kw">print</span>(t)</a></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]
## [1,] -0.4073042 -0.7209869 -1.2219126
## [2,] -0.6576684 -1.4725115 -1.9730053
## [3,] -0.3211838 -0.7568440 -0.9635513</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">cov</span>(t)</a></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]
## [1,] 0.03055348 0.07097965 0.09166044
## [2,] 0.07097965 0.17970914 0.21293897
## [3,] 0.09166044 0.21293897 0.27498134</code></pre>
<p>hw 10.11</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># 5.1</span></a>
<a class="sourceLine" id="cb29-2" title="2">n=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb29-3" title="3">m=<span class="fl">1e5</span></a>
<a class="sourceLine" id="cb29-4" title="4">t1=<span class="kw">runif</span>(n,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb29-5" title="5">t2=<span class="kw">runif</span>(m,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb29-6" title="6">theta.hat1=<span class="kw">mean</span>(<span class="kw">sin</span>(t1))<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-7" title="7">theta.hat2=<span class="kw">mean</span>(<span class="kw">sin</span>(t2))<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat1,theta.hat2,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))))</a></code></pre></div>
<pre><code>## [1] 0.5037877 0.5002745 0.5000000</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># 5.10</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co">#Monte Carlo estimate</span></a>
<a class="sourceLine" id="cb31-3" title="3">n=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb31-4" title="4">x=<span class="kw">runif</span>(n,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-5" title="5">theta.hat=<span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb31-6" title="6">t=<span class="kw">integrate</span>(<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>),<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-7" title="7">theta.hat;t</a></code></pre></div>
<pre><code>## [1] 0.5245592</code></pre>
<pre><code>## 0.5247971 with absolute error &lt; 5.8e-15</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co">#antithetic variables</span></a>
<a class="sourceLine" id="cb34-2" title="2">MC.Phi=<span class="cf">function</span>(x,<span class="dt">n=</span><span class="fl">1e4</span>,<span class="dt">antithetic=</span><span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb34-3" title="3">  u=<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb34-4" title="4">  <span class="cf">if</span>(<span class="op">!</span>antithetic)v=<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)<span class="cf">else</span></a>
<a class="sourceLine" id="cb34-5" title="5">    v=<span class="dv">1</span><span class="op">-</span>u</a>
<a class="sourceLine" id="cb34-6" title="6">  u=<span class="kw">c</span>(u,v)</a>
<a class="sourceLine" id="cb34-7" title="7">  cdf=<span class="kw">numeric</span>(<span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb34-8" title="8">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){</a>
<a class="sourceLine" id="cb34-9" title="9">    g=x[i]<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>u<span class="op">*</span>x[i])<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(u<span class="op">*</span>x[i])<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb34-10" title="10">    cdf[i]=<span class="kw">mean</span>(g)</a>
<a class="sourceLine" id="cb34-11" title="11">  }</a>
<a class="sourceLine" id="cb34-12" title="12">  cdf</a>
<a class="sourceLine" id="cb34-13" title="13">}</a>
<a class="sourceLine" id="cb34-14" title="14">x=<span class="dv">1</span></a>
<a class="sourceLine" id="cb34-15" title="15">theta.hat2=<span class="kw">integrate</span>(<span class="cf">function</span>(y)<span class="kw">exp</span>(<span class="op">-</span>y)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>y<span class="op">^</span><span class="dv">2</span>),<span class="dv">0</span>,x)</a>
<a class="sourceLine" id="cb34-16" title="16">Phi=theta.hat2</a>
<a class="sourceLine" id="cb34-17" title="17">MC1=MC2=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb34-18" title="18"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb34-19" title="19">MC1[i]=<span class="kw">MC.Phi</span>(x,<span class="dt">antithetic =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb34-20" title="20">MC2[i]=<span class="kw">MC.Phi</span>(x)}</a>
<a class="sourceLine" id="cb34-21" title="21"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(MC1),<span class="kw">mean</span>(MC2)))</a></code></pre></div>
<pre><code>## [1] 0.5248772 0.5248009</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">c</span>(<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2),(<span class="kw">sd</span>(MC1)<span class="op">-</span><span class="kw">sd</span>(MC2))<span class="op">/</span><span class="kw">sd</span>(MC1))</a></code></pre></div>
<pre><code>## [1] 0.0024536896 0.0004697736 0.8085440070</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># 5.15</span></a>
<a class="sourceLine" id="cb38-2" title="2">m =<span class="dv">10000</span></a>
<a class="sourceLine" id="cb38-3" title="3">theta.hat =se =<span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb38-4" title="4">g =<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb38-5" title="5"><span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb38-6" title="6">}</a>
<a class="sourceLine" id="cb38-7" title="7">x=<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb38-8" title="8">fg=<span class="kw">g</span>(x)</a>
<a class="sourceLine" id="cb38-9" title="9">theta.hat[<span class="dv">1</span>]=<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-10" title="10">se[<span class="dv">1</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-11" title="11">x=<span class="kw">rexp</span>(m, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb38-12" title="12">fg=<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)</a>
<a class="sourceLine" id="cb38-13" title="13">theta.hat[<span class="dv">2</span>]=<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-14" title="14">se[<span class="dv">2</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-15" title="15">x=<span class="kw">rcauchy</span>(m)</a>
<a class="sourceLine" id="cb38-16" title="16">i=<span class="kw">c</span>(<span class="kw">which</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>), <span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb38-17" title="17">x[i]=<span class="dv">2</span> </a>
<a class="sourceLine" id="cb38-18" title="18">fg=<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dcauchy</span>(x)</a>
<a class="sourceLine" id="cb38-19" title="19">theta.hat[<span class="dv">3</span>]=<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-20" title="20">se[<span class="dv">3</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-21" title="21">u =<span class="kw">runif</span>(m) </a>
<a class="sourceLine" id="cb38-22" title="22">x=<span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb38-23" title="23">fg=<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb38-24" title="24">theta.hat[<span class="dv">4</span>]=<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-25" title="25">se[<span class="dv">4</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-26" title="26">u=<span class="kw">runif</span>(m) </a>
<a class="sourceLine" id="cb38-27" title="27">x=<span class="kw">tan</span>(pi <span class="op">*</span><span class="st"> </span>u <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb38-28" title="28">fg=<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>pi))</a>
<a class="sourceLine" id="cb38-29" title="29">theta.hat[<span class="dv">5</span>]=<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-30" title="30">se[<span class="dv">5</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-31" title="31"><span class="kw">rbind</span>(theta.hat,se)</a></code></pre></div>
<pre><code>##                [,1]      [,2]      [,3]      [,4]      [,5]
## theta.hat 0.5215356 0.5237563 0.5292528 0.5260135 0.5256719
## se        0.2438790 0.4179047 0.9562344 0.0965372 0.1406347</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co">#stratified importance sampling</span></a>
<a class="sourceLine" id="cb40-2" title="2">m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb40-3" title="3">u=<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb40-4" title="4">k=<span class="dv">5</span> </a>
<a class="sourceLine" id="cb40-5" title="5">r=m<span class="op">/</span>k</a>
<a class="sourceLine" id="cb40-6" title="6">n=<span class="dv">50</span></a>
<a class="sourceLine" id="cb40-7" title="7">t=<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb40-8" title="8">est=<span class="kw">matrix</span>(<span class="dv">0</span>, n, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-9" title="9">x=<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb40-10" title="10">g=<span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb40-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb40-12" title="12">est[i, <span class="dv">1</span>]=<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(m)))</a>
<a class="sourceLine" id="cb40-13" title="13"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)t[j]=<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(m<span class="op">/</span>k,(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k)))</a>
<a class="sourceLine" id="cb40-14" title="14">est[i, <span class="dv">2</span>]=<span class="kw">mean</span>(t)</a>
<a class="sourceLine" id="cb40-15" title="15">}</a>
<a class="sourceLine" id="cb40-16" title="16"><span class="kw">apply</span>(est,<span class="dv">2</span>,mean)</a></code></pre></div>
<pre><code>## [1] 0.5250706 0.5246754</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">apply</span>(est,<span class="dv">2</span>,var)</a></code></pre></div>
<pre><code>## [1] 7.033147e-06 2.618604e-07</code></pre>
<p>hw 10.18</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co">#6.5</span></a>
<a class="sourceLine" id="cb44-2" title="2">n=<span class="dv">20</span></a>
<a class="sourceLine" id="cb44-3" title="3">alpha=.<span class="dv">05</span></a>
<a class="sourceLine" id="cb44-4" title="4">theta.hat1=<span class="kw">replicate</span>(<span class="dv">10000</span>,<span class="dt">expr =</span>{</a>
<a class="sourceLine" id="cb44-5" title="5">  x=<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-6" title="6">  y=<span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb44-7" title="7">  sigma=<span class="kw">var</span>(x)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-8" title="8">  theta.hat=<span class="kw">mean</span>(x)<span class="op">-</span>(y<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sigma<span class="op">*</span><span class="kw">qt</span>(alpha,<span class="dt">df=</span><span class="dv">40</span>))<span class="op">/</span>(<span class="dv">800</span><span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb44-9" title="9">})</a>
<a class="sourceLine" id="cb44-10" title="10"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(theta.hat1<span class="op">&gt;=</span><span class="dv">2</span>)),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.8613</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">theta.hat2=<span class="kw">replicate</span>(<span class="dv">10000</span>,<span class="dt">expr =</span>{</a>
<a class="sourceLine" id="cb46-2" title="2">  x=<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb46-3" title="3">  s=<span class="kw">var</span>(x)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb46-4" title="4">  xbat=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb46-5" title="5">  xbat<span class="op">+</span><span class="kw">abs</span>((s<span class="op">*</span><span class="kw">qt</span>(alpha,<span class="dt">df=</span>n<span class="dv">-1</span>))<span class="op">/</span>n<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb46-6" title="6">})</a>
<a class="sourceLine" id="cb46-7" title="7"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(theta.hat2<span class="op">&gt;=</span><span class="dv">2</span>)),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.8923</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">ucl=<span class="kw">replicate</span>(<span class="dv">10000</span>,<span class="dt">expr =</span>{</a>
<a class="sourceLine" id="cb48-2" title="2">  x=<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb48-3" title="3">  (n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha,<span class="dt">df=</span>n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb48-4" title="4">})</a>
<a class="sourceLine" id="cb48-5" title="5"><span class="kw">mean</span>(ucl<span class="op">&gt;</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.7912</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># 6.6</span></a>
<a class="sourceLine" id="cb50-2" title="2">m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb50-3" title="3">n=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb50-4" title="4">p=<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb50-5" title="5"><span class="co">#skewness under normality</span></a>
<a class="sourceLine" id="cb50-6" title="6">ske=<span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb50-7" title="7">  x=<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb50-8" title="8">  x.bat=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb50-9" title="9">  m1=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb50-10" title="10">  m2=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb50-11" title="11">  <span class="kw">return</span> (m1<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb50-12" title="12">}</a>
<a class="sourceLine" id="cb50-13" title="13">k=<span class="kw">replicate</span>(m,<span class="kw">ske</span>(x))</a>
<a class="sourceLine" id="cb50-14" title="14">c1=<span class="kw">quantile</span>(k,p)</a>
<a class="sourceLine" id="cb50-15" title="15">c1</a></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1508327 -0.1271329  0.1277015  0.1528988</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">z=(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))<span class="op">/</span>(n<span class="op">*</span><span class="kw">dnorm</span>(c1,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">sqrt</span>(z)</a></code></pre></div>
<pre><code>##        2.5%          5%         95%       97.5% 
## 0.006382728 0.005145917 0.005208434 0.006725398</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">ske.hat=<span class="kw">rnorm</span>(m,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb54-2" title="2">c2=<span class="kw">quantile</span>(ske.hat,p)</a>
<a class="sourceLine" id="cb54-3" title="3">c2</a></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1500421 -0.1262755  0.1259869  0.1508987</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">c3=<span class="kw">qnorm</span>(p,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb56-2" title="2">c=<span class="kw">data.frame</span>(c1,c2,c3,z)</a>
<a class="sourceLine" id="cb56-3" title="3">c</a></code></pre></div>
<pre><code>##               c1         c2         c3            z
## 2.5%  -0.1508327 -0.1500421 -0.1518182 4.073922e-05
## 5%    -0.1271329 -0.1262755 -0.1274098 2.648047e-05
## 95%    0.1277015  0.1259869  0.1274098 2.712779e-05
## 97.5%  0.1528988  0.1508987  0.1518182 4.523097e-05</code></pre>
<p>hw 11.01 6.7:use R to compute the rejected proportion,because of the proportion too small,the power is not robust.but when sample from t(v),we can said the power better.in the first figure,we know when ε=0.8，the power is greatest.in tne next figure,we know the ε smaller,the power greater. 6.A:we know when the sample population is non-normality,compare the results,the sample form uniform distribution have a rate which close to the nominal rate(0.05).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># 6.7</span></a>
<a class="sourceLine" id="cb58-2" title="2">alpha=<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb58-3" title="3">n=<span class="dv">20</span></a>
<a class="sourceLine" id="cb58-4" title="4">m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb58-5" title="5">d=<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>),<span class="kw">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb58-6" title="6">N=<span class="kw">length</span>(d)</a>
<a class="sourceLine" id="cb58-7" title="7">pwr=pwr1=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb58-8" title="8">cv=<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb58-9" title="9">sk=<span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb58-10" title="10">  x.bat=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb58-11" title="11">  m1=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb58-12" title="12">  m2=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-13" title="13">  <span class="kw">return</span> (m1<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb58-14" title="14">}</a>
<a class="sourceLine" id="cb58-15" title="15"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb58-16" title="16">  e=d[j]</a>
<a class="sourceLine" id="cb58-17" title="17">  sktests=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb58-18" title="18">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb58-19" title="19">  sigma=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="dt">replace =</span> <span class="ot">TRUE</span>,n,<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e,e))</a>
<a class="sourceLine" id="cb58-20" title="20">  x=<span class="kw">rbeta</span>(n,sigma,sigma)</a>
<a class="sourceLine" id="cb58-21" title="21">  sktests[i]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</a>
<a class="sourceLine" id="cb58-22" title="22">  }</a>
<a class="sourceLine" id="cb58-23" title="23"> pwr[j]=<span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb58-24" title="24">}</a>
<a class="sourceLine" id="cb58-25" title="25"><span class="kw">mean</span>(pwr)</a></code></pre></div>
<pre><code>## [1] 0.1306118</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb60-2" title="2">  e=d[j]</a>
<a class="sourceLine" id="cb60-3" title="3">  sktests=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb60-4" title="4">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb60-5" title="5">  sigma=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">replace =</span> <span class="ot">TRUE</span>,n,<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e,e))</a>
<a class="sourceLine" id="cb60-6" title="6">  x=<span class="kw">rt</span>(n,<span class="dt">df=</span>sigma)</a>
<a class="sourceLine" id="cb60-7" title="7">  sktests[i]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</a>
<a class="sourceLine" id="cb60-8" title="8">  }</a>
<a class="sourceLine" id="cb60-9" title="9">  pwr1[j]=<span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb60-10" title="10">}</a>
<a class="sourceLine" id="cb60-11" title="11"><span class="kw">mean</span>(pwr1)</a></code></pre></div>
<pre><code>## [1] 0.6768382</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">plot</span>(d,pwr,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(d),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">pch=</span><span class="st">&quot;￥&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red3&quot;</span>)</a>
<a class="sourceLine" id="cb62-3" title="3">se=<span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb62-4" title="4"><span class="kw">lines</span>(d,pwr<span class="op">+</span>se,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb62-5" title="5"><span class="kw">lines</span>(d,pwr<span class="op">-</span>se,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb62-6" title="6"><span class="kw">plot</span>(d,pwr1,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(d),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">pch=</span><span class="st">&quot;￥&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red3&quot;</span>)</a>
<a class="sourceLine" id="cb62-7" title="7">se1=<span class="kw">sqrt</span>(pwr1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr1)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb62-8" title="8"><span class="kw">lines</span>(d,pwr1<span class="op">+</span>se1,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb62-9" title="9"><span class="kw">lines</span>(d,pwr1<span class="op">-</span>se1,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># 6.A</span></a>
<a class="sourceLine" id="cb63-2" title="2">alpha=<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb63-3" title="3">mu0=<span class="dv">1</span></a>
<a class="sourceLine" id="cb63-4" title="4">n=<span class="dv">20</span></a>
<a class="sourceLine" id="cb63-5" title="5">m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb63-6" title="6">p1=p2=p3=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb63-7" title="7"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb63-8" title="8">  x=<span class="kw">rchisq</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb63-9" title="9">  y=<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-10" title="10">  z=<span class="kw">rexp</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb63-11" title="11">  t1=<span class="kw">t.test</span>(x,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb63-12" title="12">  t2=<span class="kw">t.test</span>(y,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb63-13" title="13">  t3=<span class="kw">t.test</span>(z,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb63-14" title="14">  p1[j]=t1<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb63-15" title="15">  p2[j]=t2<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb63-16" title="16">  p3[j]=t3<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb63-17" title="17">}</a>
<a class="sourceLine" id="cb63-18" title="18">p.hat=<span class="kw">c</span>(<span class="kw">mean</span>(p1<span class="op">&lt;</span>alpha),<span class="kw">mean</span>(p2<span class="op">&lt;</span>alpha),<span class="kw">mean</span>(p3<span class="op">&lt;</span>alpha))</a>
<a class="sourceLine" id="cb63-19" title="19">se.hat=<span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb63-20" title="20"><span class="kw">data.frame</span>(p.hat,se.hat,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;(i)χ2(1)&quot;</span>,<span class="st">&quot;(ii)Uniform(0,2)&quot;</span>,<span class="st">&quot;(iii)Exponential(1)&quot;</span>))</a></code></pre></div>
<pre><code>##                      p.hat      se.hat
## (i)χ2(1)            0.0142 0.001183147
## (ii)Uniform(0,2)    0.0514 0.002208122
## (iii)Exponential(1) 0.0200 0.001400000</code></pre>
<p>hw 11.08 7.6:use R to analyze the question.in the plots figures,we know all subjects have positive correlation property.look at the sparseness of the plots,we can find their correlation size.compute the s.e,all errors are small. 7.B:compare the result of normal distribution and chisq distribution,the coverage rate of normal distribution is larger.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co"># 7.6</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb65-3" title="3"><span class="kw">pairs</span>(scor[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">COR=<span class="kw">cor</span>(scor)</a>
<a class="sourceLine" id="cb66-2" title="2">COR</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">N=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb68-2" title="2">n=<span class="dv">88</span></a>
<a class="sourceLine" id="cb68-3" title="3">r1=r2=r3=r4=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb68-4" title="4"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb68-5" title="5">  i=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb68-6" title="6">  x1=scor<span class="op">$</span>mec[i]</a>
<a class="sourceLine" id="cb68-7" title="7">  x2=scor<span class="op">$</span>vec[i]</a>
<a class="sourceLine" id="cb68-8" title="8">  x3=scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb68-9" title="9">  x4=scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb68-10" title="10">  x5=scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb68-11" title="11">  r1[j]=<span class="kw">cor</span>(x1,x2)</a>
<a class="sourceLine" id="cb68-12" title="12">  r2[j]=<span class="kw">cor</span>(x3,x4)</a>
<a class="sourceLine" id="cb68-13" title="13">  r3[j]=<span class="kw">cor</span>(x3,x5)</a>
<a class="sourceLine" id="cb68-14" title="14">  r4[j]=<span class="kw">cor</span>(x4,x5)</a>
<a class="sourceLine" id="cb68-15" title="15">}</a>
<a class="sourceLine" id="cb68-16" title="16">s.e=<span class="kw">c</span>(<span class="dt">se.r1=</span><span class="kw">sd</span>(r1),<span class="dt">se.r2=</span><span class="kw">sd</span>(r2),<span class="dt">se.r3=</span><span class="kw">sd</span>(r3),<span class="dt">se.r4=</span><span class="kw">sd</span>(r4))</a>
<a class="sourceLine" id="cb68-17" title="17"><span class="kw">print</span>(s.e,<span class="dv">4</span>)</a></code></pre></div>
<pre><code>##   se.r1   se.r2   se.r3   se.r4 
## 0.07611 0.04856 0.06026 0.06831</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># 7.B</span></a>
<a class="sourceLine" id="cb70-2" title="2">m=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb70-3" title="3">n=<span class="dv">100</span></a>
<a class="sourceLine" id="cb70-4" title="4">mu=<span class="dv">0</span></a>
<a class="sourceLine" id="cb70-5" title="5">t=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb70-6" title="6"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb70-7" title="7"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb70-8" title="8">ci.norm=ci.basic=ci.perc=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-9" title="9">sk=<span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb70-10" title="10">  x.bat=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb70-11" title="11">  m1=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb70-12" title="12">  m2=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-13" title="13">  <span class="kw">return</span> (m1<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb70-14" title="14">}</a>
<a class="sourceLine" id="cb70-15" title="15">boot.median=<span class="cf">function</span>(x,j) <span class="kw">mean</span>(<span class="kw">sk</span>(x[j]))</a>
<a class="sourceLine" id="cb70-16" title="16"><span class="co"># normal populations</span></a>
<a class="sourceLine" id="cb70-17" title="17"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb70-18" title="18"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb70-19" title="19">  x=<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb70-20" title="20">  t[j]=<span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb70-21" title="21">}  </a>
<a class="sourceLine" id="cb70-22" title="22">  de=<span class="kw">boot</span>(<span class="dt">data=</span>t,<span class="dt">statistic=</span>boot.median,<span class="dt">R=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb70-23" title="23">  ci=<span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</a>
<a class="sourceLine" id="cb70-24" title="24">  ci.norm[i,]=ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb70-25" title="25">  ci.basic[i,]=ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb70-26" title="26">  ci.perc[i,]=ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb70-27" title="27">}</a>
<a class="sourceLine" id="cb70-28" title="28">p1.norm=<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu<span class="op">&amp;</span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>mu),<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>mu))</a>
<a class="sourceLine" id="cb70-29" title="29">p1.basic=<span class="kw">c</span>(<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu<span class="op">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>mu),<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>mu))</a>
<a class="sourceLine" id="cb70-30" title="30">p1.perc=<span class="kw">c</span>(<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu<span class="op">&amp;</span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>mu),<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>mu))</a>
<a class="sourceLine" id="cb70-31" title="31"><span class="kw">data.frame</span>(p1.norm,p1.basic,p1.perc,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;on the left&quot;</span>,<span class="st">&quot;on the right&quot;</span>))</a></code></pre></div>
<pre><code>##              p1.norm p1.basic p1.perc
## coverage       0.902    0.897   0.932
## on the left    0.052    0.055   0.041
## on the right   0.046    0.048   0.027</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co"># χ2(5) distributions</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">library</span>(moments)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;moments&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:e1071&#39;:
## 
##     kurtosis, moment, skewness</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">mu1=(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb75-2" title="2">t=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb75-3" title="3"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb75-4" title="4"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb75-6" title="6"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb75-7" title="7">  x=<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb75-8" title="8">  t[j]=<span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb75-9" title="9">}  </a>
<a class="sourceLine" id="cb75-10" title="10">  de=<span class="kw">boot</span>(<span class="dt">data=</span>t,<span class="dt">statistic=</span>boot.median,<span class="dt">R=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb75-11" title="11">  ci=<span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</a>
<a class="sourceLine" id="cb75-12" title="12">  ci.norm[i,]=ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb75-13" title="13">  ci.basic[i,]=ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb75-14" title="14">  ci.perc[i,]=ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb75-15" title="15">}</a>
<a class="sourceLine" id="cb75-16" title="16">p2.norm=<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1),<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1))</a>
<a class="sourceLine" id="cb75-17" title="17">p2.basic=<span class="kw">c</span>(<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1),<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1))</a>
<a class="sourceLine" id="cb75-18" title="18">p2.perc=<span class="kw">c</span>(<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1),<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1))</a>
<a class="sourceLine" id="cb75-19" title="19"><span class="kw">data.frame</span>(p2.norm,p2.basic,p2.perc,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;on the left&quot;</span>,<span class="st">&quot;on the right&quot;</span>))</a></code></pre></div>
<pre><code>##              p2.norm p2.basic p2.perc
## coverage       0.624    0.594   0.590
## on the left    0.026    0.063   0.002
## on the right   0.350    0.343   0.408</code></pre>
<p>hw 11.16 look at the result,we know when the model is quadratic,the error is least0.05452,the model is Y=24.49262-1.39334X+0.05707<span class="math inline">\(X^{2}\)</span>；when the is quadratic,the <span class="math inline">\(R^{2}\)</span> is largest,too.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># 7.8</span></a>
<a class="sourceLine" id="cb77-2" title="2">n=<span class="dv">5</span>;m=<span class="dv">88</span></a>
<a class="sourceLine" id="cb77-3" title="3"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb77-4" title="4">COV<span class="fl">.0</span>=<span class="kw">cov</span>(scor)</a>
<a class="sourceLine" id="cb77-5" title="5">COV=(<span class="dv">87</span><span class="op">/</span><span class="dv">88</span>)<span class="op">*</span>COV<span class="fl">.0</span></a>
<a class="sourceLine" id="cb77-6" title="6">eigen=<span class="kw">c</span>(<span class="kw">eigen</span>(COV,<span class="dt">only.values=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb77-7" title="7">e=<span class="kw">c</span>(eigen<span class="op">$</span>values[<span class="dv">1</span><span class="op">:</span><span class="dv">1</span>],eigen<span class="op">$</span>values[<span class="dv">2</span><span class="op">:</span><span class="dv">2</span>],eigen<span class="op">$</span>values[<span class="dv">3</span><span class="op">:</span><span class="dv">3</span>],eigen<span class="op">$</span>values[<span class="dv">4</span><span class="op">:</span><span class="dv">4</span>],eigen<span class="op">$</span>values[<span class="dv">5</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb77-8" title="8">theta.hat=<span class="kw">max</span>(e)<span class="op">/</span><span class="kw">sum</span>(e)</a>
<a class="sourceLine" id="cb77-9" title="9">theta.jack=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb77-10" title="10">e.hat=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb77-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb77-12" title="12"> COV.hat0=<span class="kw">cov</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb77-13" title="13"> COV.hat=(<span class="dv">87</span><span class="op">/</span><span class="dv">88</span>)<span class="op">*</span>COV.hat0</a>
<a class="sourceLine" id="cb77-14" title="14"> eigen.hat=<span class="kw">eigen</span>(COV.hat)</a>
<a class="sourceLine" id="cb77-15" title="15"> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb77-16" title="16">   e.hat[j]=eigen.hat<span class="op">$</span>values[j<span class="op">:</span>j]</a>
<a class="sourceLine" id="cb77-17" title="17"> }</a>
<a class="sourceLine" id="cb77-18" title="18"> theta.jack[i]=<span class="kw">max</span>(e.hat)<span class="op">/</span><span class="kw">sum</span>(e.hat)</a>
<a class="sourceLine" id="cb77-19" title="19">}</a>
<a class="sourceLine" id="cb77-20" title="20">bias.jack=(m<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb77-21" title="21">se.jack=<span class="kw">sqrt</span>((m<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb77-22" title="22">bias.jack;se.jack</a></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<pre><code>## [1] 0.04955244</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co"># 7.10</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># estimate</span></a>
<a class="sourceLine" id="cb84-2" title="2">a=<span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb84-3" title="3"><span class="co">## linear</span></a>
<a class="sourceLine" id="cb84-4" title="4">J10=<span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb84-5" title="5">yhat10=J10<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J10<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span>a</a>
<a class="sourceLine" id="cb84-6" title="6">R10=<span class="kw">summary</span>(J10)</a>
<a class="sourceLine" id="cb84-7" title="7"><span class="co">## quadratic</span></a>
<a class="sourceLine" id="cb84-8" title="8">J20=<span class="kw">lm</span>(magnetic<span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb84-9" title="9">yhat20=J20<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J20<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">+</span></a>
<a class="sourceLine" id="cb84-10" title="10">J20<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb84-11" title="11">R20=<span class="kw">summary</span>(J20)</a>
<a class="sourceLine" id="cb84-12" title="12"><span class="co">## exponential</span></a>
<a class="sourceLine" id="cb84-13" title="13">J30=<span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb84-14" title="14">logyhat30=J30<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J30<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb84-15" title="15">R30=<span class="kw">summary</span>(J30)</a>
<a class="sourceLine" id="cb84-16" title="16"><span class="co">## log-log</span></a>
<a class="sourceLine" id="cb84-17" title="17">J40=<span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))</a>
<a class="sourceLine" id="cb84-18" title="18">logyhat40=J40<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J40<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(a)</a>
<a class="sourceLine" id="cb84-19" title="19">R40=<span class="kw">summary</span>(J40)</a>
<a class="sourceLine" id="cb84-20" title="20"><span class="co">## cubic</span></a>
<a class="sourceLine" id="cb84-21" title="21">J50=<span class="kw">lm</span>(magnetic<span class="op">~</span>chemical<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb84-22" title="22">yhat5=J50<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J50<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">+</span>J50<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span><span class="op">+</span>J50<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb84-23" title="23">R50=<span class="kw">summary</span>(J50)</a>
<a class="sourceLine" id="cb84-24" title="24">R1=<span class="kw">summary</span>(J10);R2=<span class="kw">summary</span>(J20);R3=<span class="kw">summary</span>(J30);R4=<span class="kw">summary</span>(J40);R5=<span class="kw">summary</span>(J50)</a>
<a class="sourceLine" id="cb84-25" title="25">R.squard=<span class="kw">c</span>(R1<span class="op">$</span>adj.r.squared,R2<span class="op">$</span>adj.r.squared,R3<span class="op">$</span>adj.r.squared,R4<span class="op">$</span>adj.r.squared,R5<span class="op">$</span>adj.r.squared)</a>
<a class="sourceLine" id="cb84-26" title="26"><span class="co"># compute the error</span></a>
<a class="sourceLine" id="cb84-27" title="27">n =<span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb84-28" title="28">e1=e2=e3=e4=e5=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb84-29" title="29"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb84-30" title="30">y=magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb84-31" title="31">x=chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb84-32" title="32"><span class="co">## linear</span></a>
<a class="sourceLine" id="cb84-33" title="33">J1=<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb84-34" title="34">yhat1=J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb84-35" title="35">e1[k]=magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb84-36" title="36"></a>
<a class="sourceLine" id="cb84-37" title="37"><span class="co">## quadratic</span></a>
<a class="sourceLine" id="cb84-38" title="38">J2=<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb84-39" title="39">yhat2=J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb84-40" title="40">J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb84-41" title="41">e2[k]=magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb84-42" title="42"></a>
<a class="sourceLine" id="cb84-43" title="43"><span class="co">## exponential</span></a>
<a class="sourceLine" id="cb84-44" title="44">J3=<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb84-45" title="45">logyhat3=J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb84-46" title="46">yhat3=<span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb84-47" title="47">e3[k]=magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb84-48" title="48"></a>
<a class="sourceLine" id="cb84-49" title="49"><span class="co">## log-log</span></a>
<a class="sourceLine" id="cb84-50" title="50">J4=<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb84-51" title="51">logyhat4=J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</a>
<a class="sourceLine" id="cb84-52" title="52">yhat4=<span class="kw">exp</span>(logyhat4)</a>
<a class="sourceLine" id="cb84-53" title="53">e4[k]=magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb84-54" title="54"></a>
<a class="sourceLine" id="cb84-55" title="55"><span class="co">## cubic</span></a>
<a class="sourceLine" id="cb84-56" title="56">J5=<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb84-57" title="57">yhat5=J5<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J5<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">+</span>J5<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span><span class="op">+</span>J5<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb84-58" title="58">e5[k]=magnetic[k]<span class="op">-</span>yhat5</a>
<a class="sourceLine" id="cb84-59" title="59"></a>
<a class="sourceLine" id="cb84-60" title="60">}</a>
<a class="sourceLine" id="cb84-61" title="61">error=<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e5<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb84-62" title="62">R.squard=<span class="kw">c</span>(R1<span class="op">$</span>adj.r.squared,R2<span class="op">$</span>adj.r.squared,R3<span class="op">$</span>adj.r.squared,R4<span class="op">$</span>adj.r.squared,R5<span class="op">$</span>adj.r.squared)</a>
<a class="sourceLine" id="cb84-63" title="63"><span class="kw">data.frame</span>(error,R.squard,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;linear&quot;</span>,<span class="st">&quot;quadratic&quot;</span>,<span class="st">&quot;exponential&quot;</span>,<span class="st">&quot;log-log&quot;</span>,<span class="st">&quot;cubic&quot;</span>))</a></code></pre></div>
<pre><code>##                error  R.squard
## linear      19.55644 0.5281545
## quadratic   17.85248 0.5768151
## exponential 18.44188 0.5280556
## log-log     20.45424 0.4870624
## cubic       18.17756 0.5740396</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">J20</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>hw 11.22 8.3:use R to compute the power.when the sample sizes are not equal,the power is smaller than the power which use the permutation test. page31:look at the figures,we know when n is larger,the power larger,and the distance correlation test ia better.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># 8.3</span></a>
<a class="sourceLine" id="cb88-2" title="2">n=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb88-3" title="3">K=<span class="dv">1</span><span class="op">:</span><span class="dv">50</span></a>
<a class="sourceLine" id="cb88-4" title="4">m=<span class="dv">20</span></a>
<a class="sourceLine" id="cb88-5" title="5">power=x=y=z=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb88-6" title="6"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb88-7" title="7"><span class="co"># bulid a function</span></a>
<a class="sourceLine" id="cb88-8" title="8">count5test=<span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb88-9" title="9">X=x<span class="op">-</span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb88-10" title="10">Y=x<span class="op">-</span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb88-11" title="11">outx=<span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb88-12" title="12">outy=<span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb88-13" title="13"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb88-14" title="14">}</a>
<a class="sourceLine" id="cb88-15" title="15"><span class="co"># permutation test method</span></a>
<a class="sourceLine" id="cb88-16" title="16">p=<span class="kw">replicate</span>(n,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb88-17" title="17">  x=<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb88-18" title="18">  y=<span class="kw">rnorm</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb88-19" title="19">  x=x<span class="op">-</span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb88-20" title="20">  y=y<span class="op">-</span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb88-21" title="21">  z=<span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb88-22" title="22"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb88-23" title="23">  k=<span class="kw">sample</span>(K,m,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb88-24" title="24">  x1=z[k]</a>
<a class="sourceLine" id="cb88-25" title="25">  y1=z[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb88-26" title="26">  power[i]=<span class="kw">count5test</span>(x1,y1)</a>
<a class="sourceLine" id="cb88-27" title="27">}</a>
<a class="sourceLine" id="cb88-28" title="28">  <span class="kw">mean</span>(power)</a>
<a class="sourceLine" id="cb88-29" title="29">  })</a>
<a class="sourceLine" id="cb88-30" title="30">p1=<span class="kw">mean</span>(p)</a>
<a class="sourceLine" id="cb88-31" title="31">p1</a></code></pre></div>
<pre><code>## [1] 0.020361</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co"># page 31</span></a>
<a class="sourceLine" id="cb90-2" title="2">dCov=<span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb90-3" title="3">x=<span class="kw">as.matrix</span>(x); y=<span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb90-4" title="4">n=<span class="kw">nrow</span>(x); m=<span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb90-5" title="5"><span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb90-6" title="6"><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb90-7" title="7"><span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb90-8" title="8">Akl=<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb90-9" title="9">d=<span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb90-10" title="10">m=<span class="kw">rowMeans</span>(d); M=<span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb90-11" title="11">a=<span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b=<span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb90-12" title="12">b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb90-13" title="13">}</a>
<a class="sourceLine" id="cb90-14" title="14">A=<span class="kw">Akl</span>(x); B=<span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb90-15" title="15"><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb90-16" title="16">}</a>
<a class="sourceLine" id="cb90-17" title="17">ndCov2=<span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb90-18" title="18"><span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb90-19" title="19">p=dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb90-20" title="20">q=dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb90-21" title="21">d=p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb90-22" title="22">x=z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb90-23" title="23">y=z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb90-24" title="24"><span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-25" title="25">}</a>
<a class="sourceLine" id="cb90-26" title="26"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb90-27" title="27"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb90-28" title="28"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb93-2" title="2">m=<span class="dv">10</span></a>
<a class="sourceLine" id="cb93-3" title="3">sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-4" title="4">p.cor=p.ball=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb93-5" title="5"><span class="co"># model 1</span></a>
<a class="sourceLine" id="cb93-6" title="6">p=<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb93-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb93-8" title="8">x=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb93-9" title="9">e=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb93-10" title="10">y=(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>x<span class="op">+</span>e</a>
<a class="sourceLine" id="cb93-11" title="11">z=<span class="kw">cbind</span>(x,y)</a>
<a class="sourceLine" id="cb93-12" title="12">boot.obj=<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">99</span>,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb93-13" title="13">tb =<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb93-14" title="14">p.cor[i] =<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb93-15" title="15">p.ball[i] =<span class="st"> </span><span class="kw">bcov.test</span>(z[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R=</span><span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb93-16" title="16">}</a>
<a class="sourceLine" id="cb93-17" title="17"><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(p.cor),<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(p.ball))}</a>
<a class="sourceLine" id="cb93-18" title="18">t=<span class="kw">rbind</span>(<span class="kw">p</span>(<span class="dv">5</span>),<span class="kw">p</span>(<span class="dv">10</span>),<span class="kw">p</span>(<span class="dv">20</span>),<span class="kw">p</span>(<span class="dv">30</span>),<span class="kw">p</span>(<span class="dv">40</span>),<span class="kw">p</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb93-19" title="19"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">10</span>)),t[,<span class="dv">1</span>],<span class="st">&#39;l&#39;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&#39;n&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;model 1&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;power&#39;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb93-20" title="20"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">10</span>)),t[,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb93-21" title="21"><span class="kw">legend</span>(<span class="dv">35</span>,<span class="fl">0.4</span>,<span class="kw">c</span>(<span class="st">&#39;p.cor&#39;</span>,<span class="st">&#39;p.ball&#39;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb93-22" title="22">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>),<span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="co"># model 2</span></a>
<a class="sourceLine" id="cb94-2" title="2">f=<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb94-4" title="4">x=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb94-5" title="5">e=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb94-6" title="6">y=(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>x<span class="op">*</span>e</a>
<a class="sourceLine" id="cb94-7" title="7">z=<span class="kw">cbind</span>(x,y)</a>
<a class="sourceLine" id="cb94-8" title="8">boot.obj=<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">99</span>,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb94-9" title="9">tb =<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb94-10" title="10">p.cor[i] =<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb94-11" title="11">p.ball[i] =<span class="st"> </span><span class="kw">bcov.test</span>(z[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R=</span><span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb94-12" title="12">}</a>
<a class="sourceLine" id="cb94-13" title="13"><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(p.cor),<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(p.ball))}</a>
<a class="sourceLine" id="cb94-14" title="14">t=<span class="kw">rbind</span>(<span class="kw">f</span>(<span class="dv">5</span>),<span class="kw">f</span>(<span class="dv">10</span>),<span class="kw">f</span>(<span class="dv">20</span>),<span class="kw">f</span>(<span class="dv">30</span>),<span class="kw">f</span>(<span class="dv">40</span>),<span class="kw">f</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb94-15" title="15"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">10</span>)),t[,<span class="dv">1</span>],<span class="st">&#39;l&#39;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&#39;n&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;model 2&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;power&#39;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb94-16" title="16"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">10</span>)),t[,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb94-17" title="17"><span class="kw">legend</span>(<span class="dv">35</span>,<span class="fl">0.4</span>,<span class="kw">c</span>(<span class="st">&#39;p.cor&#39;</span>,<span class="st">&#39;p.ball&#39;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb94-18" title="18">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>),<span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>hw 11.29 9.4:use R to generate the chain,when sigma are different,look at the plots,when know when sigma is 1,the chain is mixing well.(the rate is not small and coverage is fast)</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">N=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb95-2" title="2">df=<span class="cf">function</span>(x)(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb95-3" title="3">rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb95-4" title="4">x=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb95-5" title="5">x[<span class="dv">1</span>] =<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb95-6" title="6">u=<span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb95-7" title="7">k =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb95-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb95-9" title="9">y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb95-10" title="10"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">df</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">df</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb95-11" title="11">x[i] =<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb95-12" title="12">x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb95-13" title="13">k =<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb95-14" title="14">}</a>
<a class="sourceLine" id="cb95-15" title="15">}</a>
<a class="sourceLine" id="cb95-16" title="16"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb95-17" title="17">}</a>
<a class="sourceLine" id="cb95-18" title="18"><span class="co"># generated for different variances σ2 of the proposal distribution</span></a>
<a class="sourceLine" id="cb95-19" title="19">sigma=<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb95-20" title="20">m=<span class="dv">4</span>;p=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb95-21" title="21">x0=<span class="dv">10</span></a>
<a class="sourceLine" id="cb95-22" title="22">rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb95-23" title="23">rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb95-24" title="24">rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb95-25" title="25">rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb95-26" title="26">rw=<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb95-27" title="27"><span class="co"># rates</span></a>
<a class="sourceLine" id="cb95-28" title="28"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb95-29" title="29">        p[i]=rw[i]<span class="op">/</span>N</a>
<a class="sourceLine" id="cb95-30" title="30">}</a>
<a class="sourceLine" id="cb95-31" title="31">q=<span class="dv">1</span><span class="op">-</span>p</a>
<a class="sourceLine" id="cb95-32" title="32"> rw</a></code></pre></div>
<pre><code>## [1]  15 173 299 851</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"> p</a></code></pre></div>
<pre><code>## [1] 0.015 0.173 0.299 0.851</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"> q</a></code></pre></div>
<pre><code>## [1] 0.985 0.827 0.701 0.149</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"> <span class="co"># plots</span></a>
<a class="sourceLine" id="cb101-2" title="2"> index=<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb101-3" title="3"> y1=rw1<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb101-4" title="4"> <span class="kw">plot</span>(index, y1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.05&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"> y2=rw2<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb102-2" title="2"> <span class="kw">plot</span>(index, y2, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.5&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"> y3=rw3<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb103-2" title="2"> <span class="kw">plot</span>(index, y3, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"> y4=rw4<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb104-2" title="2"> <span class="kw">plot</span>(index, y4, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=10&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOpBmZmZmkLZmtrZmtttmtv+QOgCQOmaQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb2//b/9vb////AAD/tmb/25D/27b//7b//9v///8SpSMkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJOElEQVR4nO3dgXabNhgFYDlNFm/p1tnrti7Ntq6Lu7Zx2m6G1Nb7P9gQAixA4gIWRsb3ntM2Nei3+SIETmQQkmmMGPsFhB4CgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEMj7Q7k5cbfo2XmVtd++EmL3qXaYhJw2kWNK2SQ2Va68vTGd8oP75/FJkQGsxeysfhXjt/0lGA3q8SXaKHz4UPUj1hsv7lbh42C7F9ecbMbuVj/PkIbVySvE8+fJpLnRm94mKmM112zvVefTfvjMW0Fpv58VDBqR3ktmNBtK5ydaQcYFSBrp8r3GTFgu5H5C8ZiQg1Us28pNINkwDJQbXm91KZEALtUzcKsd0jW82ymZRAnp8scl6X7pIASlNzxkJKNmky/f6S72ReuMSmxQoeUD/nW26lF/+ubEMwtMF0nvUs1ebbCPzQ1k+Buk+lm/67k9hP0pNF0h+fan3lL/1RmoOB5DSvPzri3rA3MXkpIESojc36VEa9yC9/Vs30AQHaZ3dH4mHbQwqA8XpCU5tkJb7U4T8QDidw3yyzT9u1H6Wd57yUazWg642X+/cY5A6Ubyd2Iniu6Ij2M6D6mNQ4yA9ybcan9QI9Lx8Jv39B/dR7PLtuj4GF+/jdu/mk32zWsog4+xBCQUoGX1epB1miN3kkIQCFJeOTgElFCD59ed59vY+rAQDFGoIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEM9A4mQyFpDfcsOFQCAEAjkyUGXXjiIvVYfMyD2IQKAcgUA5AoFyBALlCATKEQiUIxAoRyBQjkCgHIFAubMFWglxnX54zfXRvjMHWqcfLk0/7bZoLHemQLu7hCVOP7C0dnzu7byBtstkz4rTz0XG5U9HVn+SeaZA7EEoxRiUUjWUO1cgHsV8PS+BQDkCgXIEAuUIBMoRCJQjEChHIFCOQKAcgUA5AoFyBALlCFStwp8HdStHIFCOQKAcgUA5AoFyBALlCATKEQiUIxAolwOFC0UgkDCBApqBPyjQ09x5YevzBiruCCKE6/L65w0kY32TC/YgZ7ZLfZeGKpDrxx1nByTlKr3Bzjn2oN2/7RqsxeI8gbZLfbH03e/g7iZP82dnCZSMwGrumOXWA9Xs7tz3r5gyUHZzCsfUsW7lpgmUCh14b5NJA62EuD3kjpVGuSkCZXdYig+7BVX4QNlL6AH0i+468CjWptwUgfykP1A/vO6NAgGKSq8mj3cgSyNUJjCg8sslUHug2qb5AYoIlK/uqBIoUO3HHSaQVcU7UPZAoEDVchWgaoeKPAFFdqDGStMDsi/QQPJ0gYxdoDuQbh7lcR6szDpTAoogkDTHrkYgOSWgfI9AQJE3oKjechJA1U1vARTZgWq9KQoHKJIOoKgrUFTuXftHThpID64FkCbbH3u6AkXmajnCaQPJAijHAUBFR/EEFE0OSNqB5BSBZBugElJroMgGFAUClN+32/lj2RpQVAPKNrArULGsHVBkAhnD/LBA6/yXQrHrt0MtgfIFRksItB/xIwuQLANFZSBjTxwSyLjeArw0RQEUWYGKf4pgIBntKxdQQQGlFzfRgRc36QeUv/myj0EVoP050R5332sLoOh4QB56kPHyjeP6/rwpr1MCkjagEnAjUGQ83bBAyRiUdaF2Y5CRAijfnv3WGDYuoOKMswloT2B8C4p9b/+EHbe76wQqvSM5f/1qAkkpEZDx2huBzAcdQPsnru9i0lxaeqE4A54HSXOA8AKU97Xq+OUEMgadYmnphbbeIl+pAMluQMZ/pQVIZvuSZYkFKP8WlVoX415AQLIXUBRFNiApm4Gqo1q96UkAyXwt42sHRz0tgFzABDKArD1Ihg5UTj8gS6GpApnpBNRY50SA8pdkADUaHAVIhggkRwFyVwzlPCh/Ofl3k0ClclWg/Et3Jg7kvHZH8SbTI1BjzJ8Q2FfQ/4TUg+pfWuIfyNHTThWoecdpHwiUhUAnAmSEQEa5IIAaQyCQAIF8ETTnlIGOkiCA2n9m9fgZFaj7hQWOn3F7UOcLC4yQcXcx14UFquXOFqjthQXCz3CDdKsLC4SfAY9itgsLdL8J99gZ8jDf4sIC4WdYIPfFB9rd6z2EjATUrihYftjiQ5sftroKgUAIBEKgg0OgA4sS6LDlBCLQYcunDzSlEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEIh/oFikV+6uJL1mw6K03L6iPU9zIa77tn767sHetE0N70Bx8pRx7Wl3d8lDa7WNxXL7io6iVxt9Tfk+rbfLdK5OvWmrGr6B9E/0V9eVh/Wv89cXD8Vyx4oNRXu2jvVkpnrTdjV8AxUS1tc6uy+WN65YLfrtfaV6+9axWKSXiag3bVfDO1C6LbH9WVfJq8qXN65YSXzxcZmOYL1a69XqTdvV8A2k92n7nq0mqBXLm1asJr1Vw+7uul9rbVBv2q7GEYHifIzuDjTLvtcTAHL3Wz3BsddOoseJZMyYwC7mHPnW5gTQjoO03ohkg3q1lkEN0q5jZ37hmF6HeX3horjnSYIGCuUw7zj7epovqsu7nCiqyxWl29PvNDOkE0XVVyzn72s9rUvfPShbbl3RkTh/o9KndTbM1Ju2qcE3qyAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQSHBAxi2osrSdozBMggOqh0AgBCpF7WLb5W9Lkc64UhNU3mSTZtT8FzUfbLtEF1fxmUCB1Lz85M8q8YhF9h81CUvNonLd/G2YBAq00HM201mEq9m97jRqIlR88fGno+5xgQK9Tr8o5s7pYSj1Wol2ExN9JWigdQGUXZnttZqM57wE3yAJGqjSg1R2d7+2m/vrK0EDZTOZ1RiUd5v11X/wCmFeEzRQevAqjmJ6tH7ddn69p4QNVD4PSmBW6YTpYw7TwQGFFgKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBPI/nvqg363MkfAAAAAASUVORK5CYII=" /><!-- --> hw12.06 11.1:use R to compute the logarithm and exponential functions when x=10.compare the values,we find that the result does not hold exactly in computer arithmetic but near equality. use R to compute the roots.compare with 11.4,we know the results are approximate.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># 11.1</span></a>
<a class="sourceLine" id="cb105-2" title="2">x=<span class="dv">10</span></a>
<a class="sourceLine" id="cb105-3" title="3">f=<span class="cf">function</span>(x)<span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb105-4" title="4">g=<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb105-5" title="5"><span class="kw">print</span>(<span class="kw">f</span>(x)<span class="op">-</span><span class="kw">g</span>(x))</a></code></pre></div>
<pre><code>## [1] -1.776357e-15</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="co"># compare f and g</span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">f</span>(x)<span class="op">-</span><span class="kw">g</span>(x)<span class="op">==</span><span class="dv">0</span></a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co"># nearly equal</span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">f</span>(x),<span class="kw">g</span>(x)))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="co"># 11.4</span></a>
<a class="sourceLine" id="cb111-2" title="2">c.k=<span class="cf">function</span>(k,a){<span class="kw">return</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>(a<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))}</a>
<a class="sourceLine" id="cb111-3" title="3">f1=<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>(u<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb111-4" title="4">f2=<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>(u<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb111-5" title="5">f=<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb111-6" title="6">(<span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f1,<span class="dv">0</span>,<span class="kw">c.k</span>(k<span class="dv">-1</span>,a))<span class="op">$</span>value<span class="dv">-2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f2,<span class="dv">0</span>,<span class="kw">c.k</span>(k,a))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb111-7" title="7">}  </a>
<a class="sourceLine" id="cb111-8" title="8"><span class="co"># compute roots</span></a>
<a class="sourceLine" id="cb111-9" title="9"><span class="kw">library</span>(rootSolve)</a>
<a class="sourceLine" id="cb111-10" title="10">t=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb111-11" title="11">n=<span class="kw">length</span>(t)</a>
<a class="sourceLine" id="cb111-12" title="12">root=root2=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb111-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb111-14" title="14">  k=t[i]</a>
<a class="sourceLine" id="cb111-15" title="15">  root[i]=<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb111-16" title="16">}</a>
<a class="sourceLine" id="cb111-17" title="17">f2=<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb111-18" title="18">  <span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb111-19" title="19">}</a>
<a class="sourceLine" id="cb111-20" title="20">f<span class="fl">.4</span>=<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb111-21" title="21">  <span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb111-22" title="22">}</a>
<a class="sourceLine" id="cb111-23" title="23">K1=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb111-24" title="24">n=<span class="kw">length</span>(K1)</a>
<a class="sourceLine" id="cb111-25" title="25">root<span class="fl">.4</span>=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb111-26" title="26"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb111-27" title="27">  k=K1[i]</a>
<a class="sourceLine" id="cb111-28" title="28">  root<span class="fl">.4</span>[i]=<span class="kw">uniroot</span>(f<span class="fl">.4</span>,<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb111-29" title="29">}</a>
<a class="sourceLine" id="cb111-30" title="30"><span class="co">#the roots of 11.5</span></a>
<a class="sourceLine" id="cb111-31" title="31">root</a></code></pre></div>
<pre><code>##  [1] 1.492104 1.533559 1.562745 1.584428 1.601182 1.614529 1.625383 1.634409
##  [9] 1.642028 1.648537 1.654188 1.659121 1.663434 1.667304 1.670732 1.673816
## [17] 1.676604 1.679153 1.681483 1.683594 1.685546 1.687356 1.720599</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="co">#the roots of 11.4</span></a>
<a class="sourceLine" id="cb113-2" title="2">root<span class="fl">.4</span></a></code></pre></div>
<pre><code>##  [1]  1.492105  1.533565  1.562774  1.584429  1.601210  1.614520  1.625383
##  [8]  1.634421  1.642056  1.648526  1.654168  1.659095  1.663433  1.667281
## [15]  1.670725  1.673824  1.676639  1.679154  1.681472  1.683596  1.685550
## [22]  1.687355  1.720600 12.180340 16.811388</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="co"># abo</span></a>
<a class="sourceLine" id="cb115-2" title="2">N=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb115-3" title="3"><span class="co"># max. number of the iteration</span></a>
<a class="sourceLine" id="cb115-4" title="4">n1=<span class="dv">28</span>;n2=<span class="dv">24</span>;n3=<span class="dv">41</span>;n4=<span class="dv">70</span></a>
<a class="sourceLine" id="cb115-5" title="5">L=<span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb115-6" title="6"><span class="co"># initial estimates </span></a>
<a class="sourceLine" id="cb115-7" title="7">tol=.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb115-8" title="8">L.old=L<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb115-9" title="9">E=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb115-10" title="10"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb115-11" title="11">  E[j]=<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>n1<span class="op">*</span><span class="kw">log</span>(L[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>n2<span class="op">*</span><span class="kw">log</span>(L[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>])<span class="op">+</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">+</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">+</span>n4<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>L[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb115-12" title="12">  model=<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb115-13" title="13">    F1=<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>n1<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">+</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">-</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n4<span class="op">/</span>x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb115-14" title="14">    F2=<span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>n2<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">-</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">-</span>x[<span class="dv">1</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n4<span class="op">/</span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb115-15" title="15">    <span class="kw">c</span>(<span class="dt">F1=</span>F1,<span class="dt">F2=</span>F2)</a>
<a class="sourceLine" id="cb115-16" title="16">  }</a>
<a class="sourceLine" id="cb115-17" title="17">  ss=<span class="kw">multiroot</span>(<span class="dt">f=</span>model,<span class="dt">star=</span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb115-18" title="18">  L=ss<span class="op">$</span>root</a>
<a class="sourceLine" id="cb115-19" title="19">  <span class="co"># update p and q</span></a>
<a class="sourceLine" id="cb115-20" title="20">  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(L<span class="op">-</span>L.old)<span class="op">/</span>L.old)<span class="op">&lt;</span>tol) <span class="cf">break</span></a>
<a class="sourceLine" id="cb115-21" title="21">  L.old=L</a>
<a class="sourceLine" id="cb115-22" title="22">}</a>
<a class="sourceLine" id="cb115-23" title="23">L.old</a></code></pre></div>
<pre><code>## [1] 0.3273442 0.3104267</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">plot</span>(E,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> hw 12.13 R loops and apply.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="co"># 3</span></a>
<a class="sourceLine" id="cb118-2" title="2">mpg=mtcars<span class="op">$</span>mpg</a>
<a class="sourceLine" id="cb118-3" title="3"> disp=mtcars<span class="op">$</span>disp</a>
<a class="sourceLine" id="cb118-4" title="4"> wt=mtcars<span class="op">$</span>wt</a>
<a class="sourceLine" id="cb118-5" title="5"> formulas=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb118-6" title="6">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb118-7" title="7">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb118-8" title="8">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb118-9" title="9">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb118-10" title="10"> n=<span class="dv">4</span>;mod=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb118-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){mod[i]=<span class="kw">lm</span>(formulas[[i]])}</a>
<a class="sourceLine" id="cb118-12" title="12">mod</a></code></pre></div>
<pre><code>## [[1]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[2]]
## (Intercept)   I(1/disp) 
##    10.75202  1557.67393 
## 
## [[3]]
## (Intercept)        disp          wt 
## 34.96055404 -0.01772474 -3.35082533 
## 
## [[4]]
## (Intercept)   I(1/disp)          wt 
##   19.024206 1142.559975   -1.797649</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">lm</span>(formulas[[i]]))</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="co"># 4</span></a>
<a class="sourceLine" id="cb122-2" title="2">bootstraps=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb122-3" title="3">  rows=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb122-4" title="4">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb122-5" title="5">})</a>
<a class="sourceLine" id="cb122-6" title="6"><span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.66981     -0.04031  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.91181     -0.04013  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.39464     -0.04515  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.18795     -0.03122  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     27.1787      -0.0323  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.82595     -0.03778  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.61119     -0.03941  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.71999     -0.04257  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.07399     -0.03936  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    32.79899     -0.05164</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1">n=<span class="dv">10</span>;model=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb124-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb124-3" title="3">  data=<span class="kw">data.frame</span>(bootstraps[[i]])</a>
<a class="sourceLine" id="cb124-4" title="4">  model[i]=<span class="kw">lm</span>(data<span class="op">$</span>mpg<span class="op">~</span>data<span class="op">$</span>disp)</a>
<a class="sourceLine" id="cb124-5" title="5">}</a>
<a class="sourceLine" id="cb124-6" title="6">model</a></code></pre></div>
<pre><code>## [[1]]
## (Intercept)   data$disp 
## 29.66981431 -0.04030816 
## 
## [[2]]
## (Intercept)   data$disp 
## 28.91181209 -0.04012886 
## 
## [[3]]
## (Intercept)   data$disp 
##  31.3946445  -0.0451456 
## 
## [[4]]
## (Intercept)   data$disp 
## 28.18795327 -0.03122119 
## 
## [[5]]
## (Intercept)   data$disp 
## 27.17873996 -0.03229687 
## 
## [[6]]
## (Intercept)   data$disp 
## 28.82595093 -0.03778174 
## 
## [[7]]
## (Intercept)   data$disp 
## 30.61118735 -0.03940851 
## 
## [[8]]
## (Intercept)   data$disp 
## 30.71999127 -0.04256845 
## 
## [[9]]
## (Intercept)   data$disp 
##  29.0739866  -0.0393601 
## 
## [[10]]
## (Intercept)   data$disp 
## 32.79898984 -0.05164229</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="co"># 5</span></a>
<a class="sourceLine" id="cb126-2" title="2">mpg=mtcars<span class="op">$</span>mpg</a>
<a class="sourceLine" id="cb126-3" title="3"> disp=mtcars<span class="op">$</span>disp</a>
<a class="sourceLine" id="cb126-4" title="4"> wt=mtcars<span class="op">$</span>wt</a>
<a class="sourceLine" id="cb126-5" title="5"> formulas=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb126-6" title="6">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb126-7" title="7">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb126-8" title="8">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb126-9" title="9">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb126-10" title="10">mod=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">lm</span>(formulas[[i]]))</a>
<a class="sourceLine" id="cb126-11" title="11"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">summary</span>(mod[[i]])<span class="op">$</span>r.squared)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">bootstraps=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb128-2" title="2">  rows=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb128-3" title="3">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb128-4" title="4">})</a>
<a class="sourceLine" id="cb128-5" title="5">Mod=<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb128-6" title="6"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="cf">function</span>(i)<span class="kw">summary</span>(Mod[[i]])<span class="op">$</span>r.squared)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7129334
## 
## [[2]]
## [1] 0.744549
## 
## [[3]]
## [1] 0.6936839
## 
## [[4]]
## [1] 0.7915925
## 
## [[5]]
## [1] 0.7936962
## 
## [[6]]
## [1] 0.6612054
## 
## [[7]]
## [1] 0.7692478
## 
## [[8]]
## [1] 0.6288038
## 
## [[9]]
## [1] 0.6250162
## 
## [[10]]
## [1] 0.6763515</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="co"># 3</span></a>
<a class="sourceLine" id="cb130-2" title="2">trials=<span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb130-3" title="3"><span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 0.41609220 0.14535987 0.65978424 0.64120216 0.08264686 0.10490691
##   [7] 0.18090917 0.48372378 0.18476524 0.16927911 0.35902245 0.07625683
##  [13] 0.35652725 0.91832566 0.16654980 0.70993015 0.12533206 0.59239274
##  [19] 0.84730221 0.13526221 0.87210135 0.41865920 0.08055601 0.30555384
##  [25] 0.04984081 0.26007685 0.28789889 0.26838295 0.45295550 0.10584220
##  [31] 0.30025107 0.07729290 0.55705517 0.53116267 0.36415499 0.45850766
##  [37] 0.31925684 0.95937902 0.09072670 0.35332333 0.56494200 0.26675641
##  [43] 0.31863958 0.99182577 0.28143600 0.90534091 0.75814176 0.64710526
##  [49] 0.41452911 0.57654326 0.27106453 0.54477276 0.96351213 0.64501701
##  [55] 0.17500469 0.05700096 0.22569745 0.33750281 0.38987357 0.88846270
##  [61] 0.63770834 0.19096285 0.21080009 0.54462900 0.37263642 0.27456549
##  [67] 0.91338256 0.03956460 0.35218639 0.48082305 0.68946054 0.85934491
##  [73] 0.68644905 0.60928371 0.24602031 0.47947475 0.17879993 0.85073976
##  [79] 0.18189200 0.78596329 0.40370307 0.78976339 0.20561163 0.88070269
##  [85] 0.52322759 0.39812291 0.15867931 0.36083980 0.13891953 0.73707857
##  [91] 0.93663502 0.31855308 0.25119744 0.19184044 0.60154231 0.69934593
##  [97] 0.44498445 0.11197504 0.88104640 0.10642174</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">p=<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb132-2" title="2">  p.value=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb132-3" title="3">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb132-4" title="4">    result=trials[[i]]</a>
<a class="sourceLine" id="cb132-5" title="5">    p.value[i]=result<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb132-6" title="6">  }</a>
<a class="sourceLine" id="cb132-7" title="7">  p.value</a>
<a class="sourceLine" id="cb132-8" title="8">}</a>
<a class="sourceLine" id="cb132-9" title="9"><span class="kw">p</span>(<span class="dv">100</span>)</a></code></pre></div>
<pre><code>##   [1] 0.41609220 0.14535987 0.65978424 0.64120216 0.08264686 0.10490691
##   [7] 0.18090917 0.48372378 0.18476524 0.16927911 0.35902245 0.07625683
##  [13] 0.35652725 0.91832566 0.16654980 0.70993015 0.12533206 0.59239274
##  [19] 0.84730221 0.13526221 0.87210135 0.41865920 0.08055601 0.30555384
##  [25] 0.04984081 0.26007685 0.28789889 0.26838295 0.45295550 0.10584220
##  [31] 0.30025107 0.07729290 0.55705517 0.53116267 0.36415499 0.45850766
##  [37] 0.31925684 0.95937902 0.09072670 0.35332333 0.56494200 0.26675641
##  [43] 0.31863958 0.99182577 0.28143600 0.90534091 0.75814176 0.64710526
##  [49] 0.41452911 0.57654326 0.27106453 0.54477276 0.96351213 0.64501701
##  [55] 0.17500469 0.05700096 0.22569745 0.33750281 0.38987357 0.88846270
##  [61] 0.63770834 0.19096285 0.21080009 0.54462900 0.37263642 0.27456549
##  [67] 0.91338256 0.03956460 0.35218639 0.48082305 0.68946054 0.85934491
##  [73] 0.68644905 0.60928371 0.24602031 0.47947475 0.17879993 0.85073976
##  [79] 0.18189200 0.78596329 0.40370307 0.78976339 0.20561163 0.88070269
##  [85] 0.52322759 0.39812291 0.15867931 0.36083980 0.13891953 0.73707857
##  [91] 0.93663502 0.31855308 0.25119744 0.19184044 0.60154231 0.69934593
##  [97] 0.44498445 0.11197504 0.88104640 0.10642174</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="co"># 7</span></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="kw">library</span>(parallelsugar)</a>
<a class="sourceLine" id="cb134-3" title="3">mpg=mtcars<span class="op">$</span>mpg</a>
<a class="sourceLine" id="cb134-4" title="4"> disp=mtcars<span class="op">$</span>disp</a>
<a class="sourceLine" id="cb134-5" title="5"> wt=mtcars<span class="op">$</span>wt</a>
<a class="sourceLine" id="cb134-6" title="6"> formulas=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb134-7" title="7">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb134-8" title="8">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb134-9" title="9">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb134-10" title="10">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb134-11" title="11">mod=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">lm</span>(formulas[[i]]))</a>
<a class="sourceLine" id="cb134-12" title="12"><span class="kw">mclapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">summary</span>(mod[[i]])<span class="op">$</span>r.squared,<span class="dt">mc.cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p>hw 12.20 use R to do this exercise，first,we creat two functions of the 9.4 and here is a example when sigma=10,x0=1 and N=10000.use ggplot2,we know the results are same.Campare the computation time of the two functions with microbenchmark,we know the rcpp is faster.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">N=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb136-2" title="2">df=<span class="cf">function</span>(x)(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb136-3" title="3">rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb136-4" title="4">x=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb136-5" title="5">x[<span class="dv">1</span>] =<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb136-6" title="6">u=<span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb136-7" title="7">k =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb136-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb136-9" title="9">y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb136-10" title="10"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">df</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">df</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb136-11" title="11">x[i] =<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb136-12" title="12">x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb136-13" title="13">k =<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb136-14" title="14">}</a>
<a class="sourceLine" id="cb136-15" title="15">}</a>
<a class="sourceLine" id="cb136-16" title="16"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb136-17" title="17">}</a>
<a class="sourceLine" id="cb136-18" title="18"><span class="co"># rcpp</span></a>
<a class="sourceLine" id="cb136-19" title="19"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb136-20" title="20"><span class="kw">cppFunction</span>(<span class="st">&#39;List RwMetropolis(double sigma, double x0, int N) {</span></a>
<a class="sourceLine" id="cb136-21" title="21"><span class="st">NumericVector x(N);</span></a>
<a class="sourceLine" id="cb136-22" title="22"><span class="st">x[0] = x0;</span></a>
<a class="sourceLine" id="cb136-23" title="23"><span class="st">NumericVector u=runif(N);</span></a>
<a class="sourceLine" id="cb136-24" title="24"><span class="st">int k = 0;</span></a>
<a class="sourceLine" id="cb136-25" title="25"><span class="st">for (int i=1;i&lt;N;i++) {</span></a>
<a class="sourceLine" id="cb136-26" title="26"><span class="st">double y = rnorm(1, x[i-1], sigma)[0];</span></a>
<a class="sourceLine" id="cb136-27" title="27"><span class="st">if (u[i] &lt;= exp2(abs(x[i-1])-abs(y))){</span></a>
<a class="sourceLine" id="cb136-28" title="28"><span class="st">x[i] = y; }</span></a>
<a class="sourceLine" id="cb136-29" title="29"><span class="st">else {</span></a>
<a class="sourceLine" id="cb136-30" title="30"><span class="st">x[i] = x[i-1];</span></a>
<a class="sourceLine" id="cb136-31" title="31"><span class="st">k += 1;</span></a>
<a class="sourceLine" id="cb136-32" title="32"><span class="st">}</span></a>
<a class="sourceLine" id="cb136-33" title="33"><span class="st">}</span></a>
<a class="sourceLine" id="cb136-34" title="34"><span class="st">return List::create(</span></a>
<a class="sourceLine" id="cb136-35" title="35"><span class="st">    _[&quot;x&quot;] = x,</span></a>
<a class="sourceLine" id="cb136-36" title="36"><span class="st">    _[&quot;k&quot;] = k</span></a>
<a class="sourceLine" id="cb136-37" title="37"><span class="st">  );</span></a>
<a class="sourceLine" id="cb136-38" title="38"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb136-39" title="39"><span class="co"># qqplot</span></a>
<a class="sourceLine" id="cb136-40" title="40">v1=<span class="kw">rw.Metropolis</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">1e3</span>)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb136-41" title="41">v2=<span class="kw">RwMetropolis</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">1e3</span>)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb136-42" title="42"><span class="kw">library</span>(qqplotr)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：ggplot2</code></pre>
<pre><code>## 
## 载入程辑包：&#39;ggplot2&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     mpg</code></pre>
<pre><code>## 
## 载入程辑包：&#39;qqplotr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     stat_qq_line, StatQqLine</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1"><span class="kw">qqplot</span>(v1,v2)</a>
<a class="sourceLine" id="cb142-2" title="2"><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="co"># compare time</span></a>
<a class="sourceLine" id="cb143-2" title="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb143-3" title="3">ts=<span class="kw">microbenchmark</span>(<span class="kw">rw.Metropolis</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">1e3</span>),<span class="kw">RwMetropolis</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">1e3</span>))</a>
<a class="sourceLine" id="cb143-4" title="4"><span class="kw">summary</span>(ts)</a></code></pre></div>
<pre><code>##                          expr      min       lq      mean   median        uq
## 1 rw.Metropolis(10, 10, 1000) 2803.001 2840.451 3435.7650 2904.001 3146.5010
## 2  RwMetropolis(10, 10, 1000)  138.201  142.551  162.2399  146.300  151.8505
##         max neval
## 1 10618.202   100
## 2  1391.901   100</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
